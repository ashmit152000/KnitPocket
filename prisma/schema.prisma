generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id           Int       @id @default(autoincrement())
  firstName    String    @map("first_name")
  lastName     String    @map("last_name")
  email        String    @unique
  password     String
  mobileNumber String    @unique @map("mobile_number")
  createdAt    DateTime  @default(now()) @map("created_at")
  updatedAt    DateTime  @default(now()) @map("updated_at")
  refreshToken String?
  expenses     Expense[]
}

enum ExpenseStatus {
  CREDITED
  DEBITED
}

model Expense {
  id         Int               @id @default(autoincrement())
  user       User              @relation(fields: [userId], references: [id])
  userId     Int               @map("user_id")
  amount     Decimal           @db.Decimal(10, 2) // ✔️ amount should be Decimal
  categories CategoryExpense[]
  type       ExpenseStatus     @default(CREDITED)
}

model Category {
  id       Int               @id @default(autoincrement())
  name     String
  expenses CategoryExpense[]
}

model CategoryExpense {
  expense  Expense  @relation(fields: [expenseId], references: [id])
  category Category @relation(fields: [categoryId], references: [id])

  expenseId  Int @map("expense_id")
  categoryId Int @map("category_id")

  @@id([expenseId, categoryId]) // ✔️ composite primary key prevents duplicates
}
